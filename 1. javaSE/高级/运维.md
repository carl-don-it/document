# 安装

## jre

仅仅需要设置bin的path位置，当然直接写命令的完整路径也是可以的。path就是为了方便检索java命令的位置

# java命令

## idea运行java程序命令解析

```bash
"C:\Program Files\Java\jdk1.8.0_202\bin\java.exe" 
-agentlib:jdwp=transport=dt_socket,address=127.0.0.1:59726,suspend=y,server=n 
-XX:TieredStopAtLevel=1 
-noverify 
-Dspring.profiles.active=dev  #使用的配置文件
-Dspring.output.ansi.enabled=always 
-Dcom.sun.management.jmxremote 
-Dspring.jmx.enabled=true 
-Dspring.liveBeansView.mbeanDomain 
-Dspring.application.admin.enabled=true 
-javaagent:C:\Users\TJR_S\.IntelliJIdea2019.3\system\captureAgent\debugger-agent.jar 
-Dfile.encoding=UTF-8  #与java读写使用的编码有关
-classpath ".;...很多绝对路径jar包" 
com.dc.crawl.CrawlApplication
```

> 注意：PowerShell需要把命令的各个分支用""包含起来，cmd则不需要。

## idea运行参数设置

vm options：jvm properties

program arguments : `public static void main(String[] args){}`中的数组

environment variables ：临时修改系统环境参数

![image-20210616105923038](img/image-20210616105923038.png)

## jvm properteis

system properties

-D=value

![image-20210616105531916](img/image-20210616105531916.png)

Set a system property value. If value is a string that contains spaces, you must enclose the string in double quotes:

如果value中有空格，则需要用双引号将该值括起来，如：-Dname=”kazaf f”。

该参数通常用于设置系统级全局变量值，如配置文件路径，保证该属性在程序中任何地方都可访问。

**注意事项**

（1）需要设置的是JVM参数而不是program参数；
（2）使用此参数的参数优先级最高，会覆盖项目中配置的此项；

```cmd
 -Ddubbo.reference.com.foo.BarService.check=false
 -Ddubbo.reference.check=false
 -Ddubbo.consumer.check=false 
 -Ddubbo.registry.check=false
 -Djdk.http.auth.tunneling.disabledSchemes="" 
 -Djdk.http.auth.proxying.disabledSchemes="" 
```

在虚拟机的系统属性中设置属性名/值对，运行在此虚拟机上的应用程序可用：

```
 System.setProperty("jdk.http.auth.tunneling.disabledSchemes", "");
System.getProperty("属性名")
```

#### **-Dfile.encoding=UTF-8**

It sets a property which defines in which encoding will Java save and read files by default. It must be set at JVM startup.

There are multiple encodings - ways to represent characters on computers. UTF-8 is one of the best to use, as it contains all special characters in many languages.

Once you don't have this property, Java might save files in a different encoding which might lead to strange characters when opening the file with text editor. You can avoid this issue by manually setting the desired encoding to your `OutputStream`

This can be overridden on runtime.

在自己读写文件的demo类就很能体现出来。

# jar

JAR（Java Archive，Java 归档文件）是与平台无关的文件格式，它允许将许多文件组合成一个压缩文件，可以使用Java软件打开。

为 J2EE 应用程序创建的 JAR 文件是 EAR 文件（企业 JAR 文件）。

JAR 文件格式以流行的 ZIP 文件格式为基础。

与 ZIP 文件不同的是，JAR 文件不仅用于压缩和发布，而且还用于部署和封装库、组件和插件程序，并可被像编译器和 JVM 这样的工具直接使用。

在 JAR 中包含特殊的文件，如 manifests 和部署描述符，用来指示工具如何处理特定的 JAR。

## 启动jar包

```java
java -jar demo.jar
    
```

## maven创建jar包

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
        <target>1.8</target>
        <source>1.8</source>
        <encoding>UTF-8</encoding>
        <showWarnings>true</showWarnings>
    </configuration>
</plugin>
```

直接package只是一个jar包，没有main函数入口，并且不会把依赖的包打进去，只会打入pom文件，也就是路径，这种jar包需要配合maven插件使用。运行的时候再查找jar具体依赖jar包。

![image-20200526154245434](img/image-20200526154245434.png)![image-20200526154610430](img/image-20200526154610430.png)![image-20200526154434887](img/image-20200526154434887.png)



打包的时候打入具体的依赖，并且运行

```xml
  <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <target>1.8</target>
                    <source>1.8</source>
                    <encoding>UTF-8</encoding>
                    <showWarnings>true</showWarnings>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-assembly-plugin</artifactId>
                <configuration>
                    <archive>
                        <manifest>
                            <mainClass>com.dc.mall.JWCrawler</mainClass>
                        </manifest>
                    </archive>
                    <descriptorRefs>
                        <descriptorRef>
                            jar-with-dependencies
                        </descriptorRef>
                    </descriptorRefs>
                </configuration>
            </plugin>
        </plugins>
    </build>
```

![image-20200526154920132](img/image-20200526154920132.png)

## 创建

https://zq99299.github.io/java-tutorial/deployment/jar/

https://docs.oracle.com/javase/tutorial/deployment/index.html

最简单的

```java
jar cvfm jar-file manifest-addition input-file(s)
```

```java
c : 创建 jar 文件
f : 输出到一个 jar 文件中
m : 希望把指定文件中的信息合并到默认清单文件中
jar-file : 输出的 jar 名称
manifest-addition : 指定文件名称或路径，该文件的内容要添加到 JAR 文件清单的内容中。（必须是 utf-8 编码）
input-file(s) : 空格分隔的一个或多个要加入到jar中的文件
```

# cmd执行乱码

```bash
# 把cmd控制台设置为utf-8编码
chcp 65001
# 把java 程序使用的编码设置为utf-8 
java -Dfile.encoding=utf-8 -jar project.jar
```

# jconsole

## 介绍

JConsole是JDK自带的Java性能分析器，用来监听Java应用程序性能和跟踪代码。默认安装在JDK的bin目录（例如：C:\Program Files\Java\jdk1.8.0_144\bin），直接双击运行即可。
 JConsole可以监听本地的应用，也可以监听远程的应用。在新建连接界面上选择本地应用，或者输入远程连接地址，格式是ip:port，**注意这个port是监听端口不是服务端口**。

```shell
java -jar -Dcom.sun.management.jmxremote  -Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.rmi.port=9999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false app-1.0.jar
```

同时还需要注意服务器的端口是否被屏蔽，hosts是否配置了实际IP。可以使用hostname -i命令来查询ip是否生效。例如实际ip是10.10.10.101，计算机名是mycomputer。hosts配置如下：

```java
10.10.10.101   mycomputer
10.10.10.101   localhost localhost.localdomain localhost4 localhost4.localdomain4
```

## 问题

[JConsole is not showing any local processes ： probably have a permission issue](http://jtuts.com/2017/02/04/jconsole-not-showing-local-processes/)

C:\Users\Username\AppData\Local\Temp
